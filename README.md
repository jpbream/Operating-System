### Credits
- A lot of code copied from [this](https://www.youtube.com/playlist?list=PLHh55M_Kq4OApWScZyPl5HhgsTJS9MZ6M) tutorial, which uses [this](https://github.com/AlgorithMan-de/wyoos) repository.
- OS Dev

### Building
Install these packages to build (Linux):
1. gcc
2. make
3. grub-common
4. grub-pc-bin
5. xorriso
6. objdump (only needed if using the `debug` script)

Run this command to build:
`bash build_os.sh ENV`
where `ENV` will be defined as a Preprocessor constant. This is to control which environment the OS is compiled for.

### Tools
- A program called [Rufus](https://rufus.ie/en_US/) for downloading the iso to a flashdrive

### Debugging
- The `debug.sh` script can be used to locate the address of faulting instructions. `bash debug.sh` will generate a dissasembly of the entire binary. `bash debug.sh find 0xstart 0xend` will dissassemble print all lines between the addresses `start` and `end`

### Laptop
- Set the `ENV` argument to `LAPTOP`.
- Use the `rufus` program to write the generated `os.iso` file to a flash drive. When the box appears, select `Write in dd mode`. Plug the flash drive into your laptop and turn it on. You will need to configure your computer to boot from the flash drive using the BIOS.
- The network functionality will not work on a laptop.

### QEMU
- Set the `ENV` argument to `QEMU`
- Run the `run_qemu.bat` script (Windows only). The same command will work in a bash script for Linux.

### VirtualBox
- set `ENV` to `VIRTUALBOX`.
- Set up a new virtual machine to run this OS. In the `Storage` section, add an `optical drive` in the `Controller: IDE` section. Have this file point to the `os.iso` file that is generated by the build script.
- Be sure to set the VirtualBox network adapter to the `AMD am79c973`

### Custom Bootloader
To create a floppy.img file and write a bootloader named `bootloader.bin`:
- `dd if=/dev/zero of=floppy.img bs=1024 count=1440`
- `dd if=bootloader.bin of=floppy.img seek=0 count=1 conv=notrunc`
